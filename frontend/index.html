<!DOCTYPE html>
<!-- CACHE BUSTER: 2026-01-03-v2-FORCE-RELOAD -->
<html lang="zh-CN">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Free-OK Computer 创意工坊 v2</title>
  <link rel="stylesheet" href="styles.css" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
</head>

<body>
  <div class="app-workspace">
    <!-- 浏览器标签栏 - 移到最顶部 -->
    <div class="browser-tabs" id="browser-tabs">
      <div class="browser-tab-list" id="browser-tab-list">
        <!-- 标签页将由 JavaScript 动态生成 -->
      </div>
      <button type="button" class="browser-new-tab" id="browser-new-tab" title="新建标签页">+</button>
    </div>

    <div class="app-workspace-content">
      <aside class="history-sidebar" id="history-sidebar">
        <button type="button" class="history-toggle" id="history-toggle" aria-expanded="false"
          aria-controls="history-panel" aria-label="展开历史会话侧栏">
          <svg class="history-toggle-icon" aria-hidden="true" viewBox="0 0 1024 1024" role="img" focusable="false"
            xmlns="http://www.w3.org/2000/svg">
            <path
              d="M64 101.3C64 80.7 80.7 64 101.3 64h821.3c20.6 0 37.3 16.7 37.3 37.3 0 20.6-16.7 37.3-37.3 37.3H101.3c-20.6 0.1-37.3-16.5-37.3-37.3zM64 512c0-20.6 16.8-37.3 37.6-37.3h484.8c20.8 0 37.6 16.6 37.6 37.3 0 20.6-16.8 37.3-37.6 37.3H101.6c-9.9 0.1-19.5-3.9-26.6-10.9-7-6.9-11-16.5-11-26.4zM64 922.7c0-20.6 16.7-37.3 37.3-37.3h821.3c20.6 0 37.3 16.7 37.3 37.3 0 20.6-16.7 37.3-37.3 37.3H101.3C80.7 960 64 943.4 64 922.7zM709.6 351.7c-14.1-14.6-13.9-37.9 0.5-52.3 14.4-14.4 37.7-14.6 52.3-0.5l186.7 186.7c14.6 14.6 14.6 38.2 0 52.8L762.4 725.1c-14.6 14.2-37.9 14-52.3-0.5s-14.6-37.7-0.5-52.3L869.9 512 709.6 351.7z"
              fill="currentColor"></path>
          </svg>
          <span class="history-toggle-label"></span>
        </button>
        <div class="history-panel" id="history-panel" tabindex="-1">
          <div class="history-panel-header">
            <h2>历史会话</h2>
            <button type="button" class="ghost-button history-new" id="new-conversation">
              <span aria-hidden="true">＋</span>
              <span>新建对话</span>
            </button>
          </div>
          <p class="history-empty" id="conversation-empty">暂无会话记录</p>
          <ul class="conversation-list" id="conversation-list"></ul>
          <div class="sidebar-footer">
            <div class="help-menu-wrapper">
              <button type="button" class="sidebar-footer-btn" id="help-feedback-btn">
                <span class="icon" aria-hidden="true">ℹ️</span>
                <span>反馈和帮助</span>
              </button>
              <div class="help-dropdown" id="help-dropdown" hidden>
                <button type="button" class="help-dropdown-item" data-action="github">
                  <span class="help-dropdown-icon">🌐</span>
                  <div class="help-dropdown-content">
                    <span class="help-dropdown-title">Github</span>
                    <span class="help-dropdown-desc">提交 Issue，反馈 BUG</span>
                  </div>
                </button>
                <button type="button" class="help-dropdown-item" data-action="qq">
                  <span class="help-dropdown-icon">💬</span>
                  <div class="help-dropdown-content">
                    <span class="help-dropdown-title">QQ群</span>
                    <span class="help-dropdown-desc">加入交流群</span>
                  </div>
                </button>
              </div>
            </div>
            <button type="button" class="sidebar-footer-btn" id="settings-btn-sidebar">
              <span class="icon" aria-hidden="true">⚙️</span>
              <span>设置</span>
            </button>
          </div>
        </div>
      </aside>

      <div class="app-shell">
        <header class="app-header">
          <div class="logo-area">
            <span class="logo">OK</span>
            <div>
              <h1>Free-OK Computer 创意工坊</h1>
              <p>以对话驱动的自动化AGENT</p>
            </div>
          </div>
          <div class="header-actions">
            <div class="status-pill" id="status-pill">待命中…</div>
            <button type="button" class="settings-toggle" id="settings-toggle" aria-haspopup="dialog"
              aria-expanded="false">
              <span aria-hidden="true">⚙️</span>
              <span>服务配置</span>
            </button>
          </div>
        </header>

        <main class="app-main">
          <section class="chat-panel">
            <div class="chat-messages" id="chat-messages"></div>
            <form class="chat-input" id="chat-form">
              <div class="chat-input-editor">
                <textarea id="user-input" rows="2" placeholder="试着说：帮我创建一个个人简历网页" required></textarea>
                <p class="chat-input-hint" id="chat-editing-hint" hidden>
                  正在编辑历史消息，点击"发送"完成修改。
                </p>
              </div>
              <input type="file" id="file-upload-input" class="file-upload-input" hidden multiple />
              <div class="chat-input-actions">
                <button type="button" class="ghost-button upload-button" id="upload-button">
                  上传文件
                </button>
                <button type="button" class="ghost-button cancel-edit-button" id="cancel-edit" hidden>
                  取消编辑
                </button>
                <button type="submit" class="send-button">发送</button>
              </div>
            </form>
          </section>
        </main>
      </div>

      <!-- Insight 侧边栏 - 移到右侧 -->
      <aside class="insight-sidebar" id="insight-sidebar">
        <div class="insight-panel-sidebar" id="insight-panel-sidebar" tabindex="-1">
          <div class="insight-panel-header">
            <h2>信息面板</h2>
          </div>

          <section class="insight-card">
            <h2>当前模型调用</h2>
            <ul class="model-log" id="model-log"></ul>
            <p class="empty-state" id="model-log-empty">暂无调用记录</p>
          </section>

          <section class="insight-card" id="uploaded-files-card" hidden>
            <h2>已上传文件</h2>
            <ul class="uploaded-file-list" id="uploaded-file-list"></ul>
            <p class="empty-state" id="uploaded-files-empty">尚未上传文件</p>
          </section>

          <section class="insight-card" id="web-preview-card" hidden>
            <div class="preview-header">
              <h2>网页预览</h2>
              <button class="ghost-button" id="open-web-preview" type="button" disabled>
                新窗口打开
              </button>
            </div>
            <div class="preview-frame">
              <iframe id="web-preview-frame" title="网页预览" sandbox="allow-popups"></iframe>
              <p class="empty-state" id="web-preview-empty">
                生成内容后将在这里展示网页效果。
              </p>
            </div>
          </section>

          <section class="insight-card" id="ppt-preview-card" hidden>
            <div class="preview-header">
              <h2>PPT 预览</h2>
              <button class="ghost-button" id="toggle-ppt-mode" type="button" disabled>
                幻灯模式
              </button>
            </div>
            <div class="ppt-preview" id="ppt-preview"></div>
            <p class="empty-state" id="ppt-preview-empty">
              等待生成幻灯片内容…
            </p>
          </section>
        </div>
        <button type="button" class="insight-toggle" id="insight-toggle" aria-expanded="false"
          aria-controls="insight-panel-sidebar" aria-label="展开信息侧栏">
          <svg class="insight-toggle-icon" aria-hidden="true" viewBox="0 0 24 24" role="img" focusable="false"
            xmlns="http://www.w3.org/2000/svg">
            <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z" fill="currentColor"></path>
          </svg>
          <span class="insight-toggle-label"></span>
        </button>
      </aside>
    </div>
  </div>

  <!-- 全局设置覆盖层 -->
  <div class="settings-overlay" id="settings-overlay" hidden>
    <div class="settings-modal" role="dialog" aria-modal="true" aria-labelledby="settings-title" tabindex="-1">
      <div class="settings-modal-header">
        <h2 id="settings-title">全局设置</h2>
        <button type="button" class="settings-modal-close" data-action="close-settings" aria-label="关闭设置">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M18 6L6 18M6 6l12 12"/>
          </svg>
        </button>
      </div>

      <!-- 设置选项卡导航 -->
      <nav class="settings-tabs" role="tablist">
        <button type="button" class="settings-tab active" role="tab" data-tab="basic" aria-selected="true">
          <span class="settings-tab-icon">⚙️</span>
          <span>基础设置</span>
        </button>
        <button type="button" class="settings-tab" role="tab" data-tab="model" aria-selected="false">
          <span class="settings-tab-icon">🤖</span>
          <span>模型配置</span>
        </button>
        <button type="button" class="settings-tab" role="tab" data-tab="ai-dialog" aria-selected="false">
          <span class="settings-tab-icon">💬</span>
          <span>AI 对话配置</span>
        </button>
        <button type="button" class="settings-tab" role="tab" data-tab="storage" aria-selected="false">
          <span class="settings-tab-icon">📁</span>
          <span>存储管理</span>
        </button>
        <button type="button" class="settings-tab" role="tab" data-tab="about" aria-selected="false">
          <span class="settings-tab-icon">ℹ️</span>
          <span>关于</span>
        </button>
      </nav>

      <!-- 设置内容区域 -->
      <div class="settings-content">
        <!-- 基础设置页 -->
        <div class="settings-page active" data-page="basic">
          <section class="settings-section">
            <h3 class="settings-section-title">
              <span class="settings-section-icon">🎨</span>
              外观设置
            </h3>
            <div class="settings-card">
              <div class="settings-item">
                <div class="settings-item-info">
                  <span class="settings-item-label">主题模式</span>
                </div>
                <div class="settings-theme-toggle">
                  <button type="button" class="theme-option active" data-theme="system">跟随系统</button>
                  <button type="button" class="theme-option" data-theme="light">浅色模式</button>
                  <button type="button" class="theme-option" data-theme="dark">深色模式</button>
                </div>
              </div>
            </div>
          </section>

          <section class="settings-section">
            <h3 class="settings-section-title">
              <span class="settings-section-icon">📷</span>
              截图设置
            </h3>
            <div class="settings-card">
              <div class="settings-item">
                <div class="settings-item-info">
                  <span class="settings-item-label">移动端适配</span>
                  <span class="settings-item-desc">截图时自动缩放宽度，适合移动端查看</span>
                </div>
                <label class="settings-switch">
                  <input type="checkbox" id="mobile-screenshot" checked />
                  <span class="settings-switch-slider"></span>
                </label>
              </div>
            </div>
          </section>

          <section class="settings-section">
            <h3 class="settings-section-title">
              <span class="settings-section-icon">🌐</span>
              网络设置
            </h3>
            <div class="settings-card">
              <div class="settings-item">
                <div class="settings-item-info">
                  <span class="settings-item-label">启用代理</span>
                  <span class="settings-item-desc">通过代理服务器连接网络（适用于需要代理的网络环境）</span>
                </div>
                <label class="settings-switch">
                  <input type="checkbox" id="enable-proxy" />
                  <span class="settings-switch-slider"></span>
                </label>
              </div>
            </div>
          </section>
        </div>

        <!-- 模型配置页 -->
        <div class="settings-page" data-page="model">
          <form class="config-form" id="config-form">
            <section class="settings-section">
              <h3 class="settings-section-title">
                <span class="settings-section-icon">💭</span>
                聊天模型
              </h3>
              <div class="settings-card">
                <div class="config-field">
                  <label>模型 ID</label>
                  <input type="text" data-service="chat" data-field="model" placeholder="moonshot-chat" />
                </div>
                <div class="config-field">
                  <label>Base URL</label>
                  <input type="url" data-service="chat" data-field="base_url" placeholder="https://api.example.com/v1/chat" />
                </div>
                <div class="config-field">
                  <label>API Key</label>
                  <input type="password" data-service="chat" data-field="api_key" placeholder="••••••" autocomplete="off" />
                </div>
              </div>
            </section>

            <section class="settings-section">
              <h3 class="settings-section-title">
                <span class="settings-section-icon">🖼️</span>
                图像生成
              </h3>
              <div class="settings-card">
                <div class="config-field">
                  <label>模型 ID</label>
                  <input type="text" data-service="image" data-field="model" placeholder="moonshot-image" />
                </div>
                <div class="config-field">
                  <label>Base URL</label>
                  <input type="url" data-service="image" data-field="base_url" placeholder="https://api.example.com/v1/images" />
                </div>
                <div class="config-field">
                  <label>API Key</label>
                  <input type="password" data-service="image" data-field="api_key" placeholder="••••••" autocomplete="off" />
                </div>
              </div>
            </section>

            <section class="settings-section">
              <h3 class="settings-section-title">
                <span class="settings-section-icon">🔊</span>
                语音合成
              </h3>
              <div class="settings-card">
                <div class="config-field">
                  <label>模型 ID</label>
                  <input type="text" data-service="speech" data-field="model" placeholder="moonshot-tts" />
                </div>
                <div class="config-field">
                  <label>Base URL</label>
                  <input type="url" data-service="speech" data-field="base_url" placeholder="https://api.example.com/v1/speech" />
                </div>
                <div class="config-field">
                  <label>API Key</label>
                  <input type="password" data-service="speech" data-field="api_key" placeholder="••••••" autocomplete="off" />
                </div>
              </div>
            </section>

            <section class="settings-section">
              <h3 class="settings-section-title">
                <span class="settings-section-icon">🎵</span>
                音效生成
              </h3>
              <div class="settings-card">
                <div class="config-field">
                  <label>模型 ID</label>
                  <input type="text" data-service="sound_effects" data-field="model" placeholder="moonshot-sfx" />
                </div>
                <div class="config-field">
                  <label>Base URL</label>
                  <input type="url" data-service="sound_effects" data-field="base_url" placeholder="https://api.example.com/v1/sfx" />
                </div>
                <div class="config-field">
                  <label>API Key</label>
                  <input type="password" data-service="sound_effects" data-field="api_key" placeholder="••••••" autocomplete="off" />
                </div>
              </div>
            </section>

            <section class="settings-section">
              <h3 class="settings-section-title">
                <span class="settings-section-icon">🎤</span>
                语音识别
              </h3>
              <div class="settings-card">
                <div class="config-field">
                  <label>模型 ID</label>
                  <input type="text" data-service="asr" data-field="model" placeholder="moonshot-asr" />
                </div>
                <div class="config-field">
                  <label>Base URL</label>
                  <input type="url" data-service="asr" data-field="base_url" placeholder="https://api.example.com/v1/asr" />
                </div>
                <div class="config-field">
                  <label>API Key</label>
                  <input type="password" data-service="asr" data-field="api_key" placeholder="••••••" autocomplete="off" />
                </div>
              </div>
            </section>

            <div class="config-actions">
              <span class="config-status" id="config-status" role="status"></span>
              <button type="submit" class="primary-button">保存配置</button>
            </div>
          </form>
        </div>

        <!-- AI 对话配置页 -->
        <div class="settings-page" data-page="ai-dialog">
          <section class="settings-section">
            <h3 class="settings-section-title">
              <span class="settings-section-icon">⚡</span>
              对话设置
            </h3>
            <div class="settings-card">
              <div class="settings-item">
                <div class="settings-item-info">
                  <span class="settings-item-label">流式输出</span>
                  <span class="settings-item-desc">实时显示 AI 回复内容</span>
                </div>
                <label class="settings-switch">
                  <input type="checkbox" id="streaming-output" checked />
                  <span class="settings-switch-slider"></span>
                </label>
              </div>
              <div class="settings-item">
                <div class="settings-item-info">
                  <span class="settings-item-label">显示推理过程</span>
                  <span class="settings-item-desc">展示 AI 的思考过程</span>
                </div>
                <label class="settings-switch">
                  <input type="checkbox" id="show-reasoning" checked />
                  <span class="settings-switch-slider"></span>
                </label>
              </div>
            </div>
          </section>

          <section class="settings-section">
            <h3 class="settings-section-title">
              <span class="settings-section-icon">📝</span>
              系统提示词
            </h3>
            <div class="settings-card">
              <div class="config-field">
                <label>自定义系统提示词</label>
                <textarea id="system-prompt" rows="4" placeholder="输入自定义的系统提示词..."></textarea>
              </div>
            </div>
          </section>
        </div>

        <!-- 存储管理页 -->
        <div class="settings-page" data-page="storage">
          <section class="settings-section">
            <h3 class="settings-section-title">
              <span class="settings-section-icon">💾</span>
              数据存储
            </h3>
            <div class="settings-card">
              <div class="settings-item">
                <div class="settings-item-info">
                  <span class="settings-item-label">对话记录</span>
                  <span class="settings-item-desc">当前存储的对话数量</span>
                </div>
                <span class="settings-item-value" id="conversation-count">0 条</span>
              </div>
              <div class="settings-item">
                <div class="settings-item-info">
                  <span class="settings-item-label">缓存大小</span>
                  <span class="settings-item-desc">本地缓存占用空间</span>
                </div>
                <span class="settings-item-value" id="cache-size">0 MB</span>
              </div>
            </div>
          </section>

          <section class="settings-section">
            <h3 class="settings-section-title">
              <span class="settings-section-icon">🗑️</span>
              清理数据
            </h3>
            <div class="settings-card">
              <div class="settings-item">
                <div class="settings-item-info">
                  <span class="settings-item-label">清除所有对话</span>
                  <span class="settings-item-desc">删除所有对话记录，此操作不可恢复</span>
                </div>
                <button type="button" class="danger-button" id="clear-conversations">清除</button>
              </div>
              <div class="settings-item">
                <div class="settings-item-info">
                  <span class="settings-item-label">清除缓存</span>
                  <span class="settings-item-desc">清除本地缓存数据</span>
                </div>
                <button type="button" class="ghost-button" id="clear-cache">清除</button>
              </div>
            </div>
          </section>
        </div>

        <!-- 关于页 -->
        <div class="settings-page" data-page="about">
          <section class="settings-section">
            <h3 class="settings-section-title">
              <span class="settings-section-icon">📖</span>
              关于应用
            </h3>
            <div class="settings-card about-card">
              <div class="about-logo">
                <span class="logo">OK</span>
              </div>
              <h4>Free-OK Computer 创意工坊</h4>
              <p class="about-desc">以对话驱动的自动化 AGENT</p>
              <p class="about-version">版本 1.0.0</p>
            </div>
          </section>

          <section class="settings-section">
            <h3 class="settings-section-title">
              <span class="settings-section-icon">🔗</span>
              相关链接
            </h3>
            <div class="settings-card">
              <a href="https://github.com/kexinoh/free-OKC" target="_blank" class="settings-link-item">
                <span class="settings-link-icon">🌐</span>
                <div class="settings-link-info">
                  <span class="settings-link-label">GitHub 仓库</span>
                  <span class="settings-link-desc">查看源代码、提交 Issue</span>
                </div>
                <span class="settings-link-arrow">→</span>
              </a>
            </div>
          </section>
        </div>
      </div>
    </div>
  </div>

  <template id="model-log-item-template">
    <li class="model-log-item">
      <header>
        <span class="model-name"></span>
        <time class="model-time"></time>
      </header>
      <p class="model-summary"></p>
      <dl class="model-meta">
        <div>
          <dt>输入 Token</dt>
          <dd class="meta-input"></dd>
        </div>
        <div>
          <dt>输出 Token</dt>
          <dd class="meta-output"></dd>
        </div>
        <div>
          <dt>耗时</dt>
          <dd class="meta-latency"></dd>
        </div>
      </dl>
    </li>
  </template>

  <template id="ppt-slide-template">
    <section class="ppt-slide">
      <h3></h3>
      <ul></ul>
    </section>
  </template>

  <script type="module" src="app/index.js"></script>
</body>

</html>